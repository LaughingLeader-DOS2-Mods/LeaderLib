Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
//REGION DUMMY_DEFINITIONS
//These are missing in the editor's Shared scripts for some reason

//Dummy definition
QRY
QRY_GLOBAL_CrimeDialogIntercept_Wrapper((INTEGER)_Automated, (GUIDSTRING)_Speaker1, (GUIDSTRING)_Speaker2, (GUIDSTRING)_Speaker3,(GUIDSTRING)_Speaker4, (GUIDSTRING)_Speaker5, (GUIDSTRING)_Speaker6)
AND
0 == 1
THEN
DB_NOOP(1);

//Dummy definition
QRY
QRY_PlayOriginMoment((STRING)_Dialog, (GUIDSTRING)_MainNPC, (GUIDSTRING)_Player)
AND
0 == 1
THEN
DB_NOOP(1);
//END_REGION

//REGION Proc_StartDialog_Override
PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1)
AND
DB_LeaderLib_DialogOverride_Registered_StoryOverride(_Speaker1, _Dialog, _UseDialog)
AND
QRY_StartDialog(_Automated,_UseDialog,_Speaker1)
THEN
DB_NOOP(1);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2)
AND
NOT QRY_GLOBAL_CrimeDialogIntercept_Wrapper(_Automated, _Speaker1,_Speaker2, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000,  NULL_00000000-0000-0000-0000-000000000000)
AND
NOT QRY_PlayOriginMoment(_Dialog,_Speaker1,_Speaker2)
AND
NOT DB_OriginRecruitmentDialog((CHARACTERGUID)_,_Dialog)
AND
DB_LeaderLib_DialogOverride_Registered_StoryOverride(_SpeakerMatch, _Dialog, _UseDialog)
AND
LeaderLib_DialogOverride_QRY_SpeakerMatch(_SpeakerMatch, _Speaker1, _Speaker2)
AND
QRY_StartDialog(_Automated,_UseDialog,_Speaker1,_Speaker2)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2,(GUIDSTRING)_Speaker3)
AND
NOT QRY_GLOBAL_CrimeDialogIntercept_Wrapper(_Automated, _Speaker1,_Speaker2, _Speaker3, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000,  NULL_00000000-0000-0000-0000-000000000000)
AND
NOT QRY_PlayOriginMoment(_Dialog,_Speaker1,_Speaker3)
AND
DB_LeaderLib_DialogOverride_Registered_StoryOverride(_SpeakerMatch, _Dialog, _UseDialog)
AND
LeaderLib_DialogOverride_QRY_SpeakerMatch(_SpeakerMatch, _Speaker1, _Speaker2, _Speaker3)
AND
QRY_StartDialog(_Automated,_UseDialog,_Speaker1,_Speaker2,_Speaker3)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2,(GUIDSTRING)_Speaker3,(GUIDSTRING)_Speaker4)
AND
NOT QRY_GLOBAL_CrimeDialogIntercept_Wrapper(_Automated, _Speaker1,_Speaker2, _Speaker3, _Speaker4, NULL_00000000-0000-0000-0000-000000000000,  NULL_00000000-0000-0000-0000-000000000000)
AND
NOT QRY_PlayOriginMoment(_Dialog,_Speaker1,_Speaker4)
AND
DB_LeaderLib_DialogOverride_Registered_StoryOverride(_SpeakerMatch, _Dialog, _UseDialog)
AND
LeaderLib_DialogOverride_QRY_SpeakerMatch(_SpeakerMatch, _Speaker1, _Speaker2, _Speaker3, _Speaker4)
AND
QRY_StartDialog(_Automated,_UseDialog,_Speaker1,_Speaker2,_Speaker3,_Speaker4)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2,(GUIDSTRING)_Speaker3,(GUIDSTRING)_Speaker4,(GUIDSTRING)_Speaker5)
AND
NOT QRY_GLOBAL_CrimeDialogIntercept_Wrapper(_Automated, _Speaker1,_Speaker2, _Speaker3, _Speaker4, _Speaker5, NULL_00000000-0000-0000-0000-000000000000)
AND
NOT QRY_PlayOriginMoment(_Dialog,_Speaker1,_Speaker5)
AND
DB_LeaderLib_DialogOverride_Registered_StoryOverride(_SpeakerMatch, _Dialog, _UseDialog)
AND
LeaderLib_DialogOverride_QRY_SpeakerMatch(_SpeakerMatch, _Speaker1, _Speaker2, _Speaker3, _Speaker4, _Speaker5)
AND
QRY_StartDialog(_Automated,_UseDialog,_Speaker1,_Speaker2,_Speaker3,_Speaker4,_Speaker5)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2,(GUIDSTRING)_Speaker3,(GUIDSTRING)_Speaker4,(GUIDSTRING)_Speaker5,(GUIDSTRING)_Speaker6)
AND
NOT QRY_GLOBAL_CrimeDialogIntercept_Wrapper(_Automated, _Speaker1,_Speaker2, _Speaker3, _Speaker4, _Speaker5, _Speaker6)
AND
NOT QRY_PlayOriginMoment(_Dialog,_Speaker1,_Speaker6)
AND
DB_LeaderLib_DialogOverride_Registered_StoryOverride(_SpeakerMatch, _Dialog, _UseDialog)
AND
LeaderLib_DialogOverride_QRY_SpeakerMatch(_SpeakerMatch, _Speaker1, _Speaker2, _Speaker3, _Speaker4, _Speaker5, _Speaker6)
AND
QRY_StartDialog(_Automated,_UseDialog,_Speaker1,_Speaker2,_Speaker3,_Speaker4,_Speaker5,_Speaker6)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);
//END_REGION

//REGION Proc_StartDialog_CLEANUP
PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1)
AND
DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2)
AND
DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2,(GUIDSTRING)_Speaker3)
AND
DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2,(GUIDSTRING)_Speaker3,(GUIDSTRING)_Speaker4)
AND
DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2,(GUIDSTRING)_Speaker3,(GUIDSTRING)_Speaker4,(GUIDSTRING)_Speaker5)
AND
DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);

PROC
Proc_StartDialog((INTEGER)_Automated,(STRING)_Dialog,(GUIDSTRING)_Speaker1,(GUIDSTRING)_Speaker2,(GUIDSTRING)_Speaker3,(GUIDSTRING)_Speaker4,(GUIDSTRING)_Speaker5,(GUIDSTRING)_Speaker6)
AND
DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch)
THEN
NOT DB_LeaderLib_DialogOverride_Temp_Match(_SpeakerMatch);
//END_REGION

//REGION BEHAVIOR_DIALOG_OVERRIDING
//Solo AD dialog
IF
AutomatedDialogStarted(_Dialog, _Instance)
AND
DB_LeaderLib_DialogOverride_Registered_BehaviorOverride((GUIDSTRING)_SpeakerMatch, _Dialog, _UseDialog)
AND
DB_DialogPlayers(_Instance, _Player, _PlayerIndex)
AND
_SpeakerMatch == _Player
AND
NOT DialogGetInvolvedNPC(_Instance, 1, _)
THEN
LeaderLib_DialogOverride_TransitionDialog(1, _Dialog, _UseDialog, _Instance, _Player);

/*
PROC
LeaderLib_DialogOverride_TransitionDialog((INTEGER)_Automated, (STRING)_Dialog, (STRING)_NextDialog, (INTEGER)_PreviousInstance, (GUIDSTRING)_Target)
AND
DB_DialogNPCs(_PreviousInstance, _Npc, _NpcIndex)
THEN
DB_LeaderLib_DialogOverride_Temp_DialogNPCs(_PreviousInstance, _Npc, _NpcIndex);

PROC
LeaderLib_DialogOverride_TransitionDialog((INTEGER)_Automated, (STRING)_Dialog, (STRING)_NextDialog, (INTEGER)_PreviousInstance, (GUIDSTRING)_Target)
AND
DB_DialogPlayers(_PreviousInstance, _Player, _PlayerIndex)
THEN
DB_LeaderLib_DialogOverride_Temp_DialogPlayers(_PreviousInstance, _Player, _PlayerIndex);
*/

PROC
LeaderLib_DialogOverride_TransitionDialog((INTEGER)_Automated, (STRING)_Dialog, (STRING)_NextDialog, (INTEGER)_PreviousInstance, (GUIDSTRING)_Target)
THEN
DialogRequestStopForDialog(_Dialog, _Target);
Proc_StartDialog(_Automated, _NextDialog, _Target);
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "__AAA_Z_LaughingLeader_TopToggledScripts"
